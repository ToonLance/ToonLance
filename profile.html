<!-- profile.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile | ToonLance</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <a href="/">ToonLance</a>
                </div>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="nav-links" id="navLinks">
                    <a href="index.html">Home</a>
                    <a href="freelancers.html">Freelancers</a>
                    <a href="projects.html">Projects</a>
                    <a id="loginLink" class="nav-link">Login</a>
                    <a id="signupLink" class="nav-link">Sign Up</a>
                    <a href="profile.html" id="profileLink" style="display: none;">Profile</a>
                    <a id="logoutLink" class="nav-link" style="display: none;">Logout</a>
                </div>
            </nav>
        </div>
    </header>

    <section class="profile" id="profile">
        <div class="container">
            <h2 class="section-title">Your Profile</h2>
            <div class="profile-details" id="profileDetails"></div>
        </div>
    </section>

    <!-- Role Selection Modal -->
    <div class="modal" id="roleModal">
        <div class="modal-content">
            <h3>Choose Your Role</h3>
            <p>Are you a client looking to hire animators or a freelancer looking for projects?</p>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="selectRole('client')">Client</button>
                <button class="btn btn-outline" onclick="selectRole('freelancer')">Freelancer</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="copyright">
            <p>Â© 2025 ToonLance. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
    <script src="firebase.js"></script>
    <script src="nav.js"></script>
    <script>
        // Load Profile
        async function loadProfile() {
            const profileDetails = document.getElementById('profileDetails');
            if (currentUser) {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                const freelancerDoc = await db.collection('freelancers').doc(currentUser.uid).get();
                profileDetails.innerHTML = `
                    <h3>${currentUser.displayName}</h3>
                    <p>Email: ${currentUser.email}</p>
                    <p>Role: ${userDoc.exists ? userDoc.data().role : 'Not set'}</p>
                `;
                if (freelancerDoc.exists) {
                    const freelancer = freelancerDoc.data();
                    profileDetails.innerHTML += `
                        <p>Skills: ${freelancer.skills.join(', ')}</p>
                        <p>Portfolio: <a href="${freelancer.portfolio}" target="_blank">${freelancer.portfolio}</a></p>
                    `;
                }
            } else {
                window.location.href = 'index.html';
            }
        }

        // Initialize
        auth.onAuthStateChanged(user => {
            currentUser = user;
            loadProfile();
        });
    </script>
</body>
</html>